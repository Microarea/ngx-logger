!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/common/http"),require("rxjs"),require("rxjs/operators"),require("@angular/core"),require("@angular/common"),require("@angular/forms"),require("@progress/kendo-angular-buttons"),require("@progress/kendo-angular-dropdowns"),require("@progress/kendo-angular-inputs"),require("@progress/kendo-angular-dateinputs"),require("@progress/kendo-angular-notification"),require("@stomp/ng2-stompjs")):"function"==typeof define&&define.amd?define("@tb/logger",["exports","@angular/common/http","rxjs","rxjs/operators","@angular/core","@angular/common","@angular/forms","@progress/kendo-angular-buttons","@progress/kendo-angular-dropdowns","@progress/kendo-angular-inputs","@progress/kendo-angular-dateinputs","@progress/kendo-angular-notification","@stomp/ng2-stompjs"],r):r((e.tb=e.tb||{},e.tb.logger={}),e.ng.common.http,e.rxjs,e.rxjs.operators,e.ng.core,e.ng.common,e.ng.forms,e.kendoAngularButtons,e.kendoAngularDropdowns,e.kendoAngularInputs,e.kendoAngularDateinputs,e.i1$1,e.i2)}(this,function(e,i,s,a,r,t,o,n,p,c,g,u,l){"use strict";function d(){}function h(){}function f(){}function v(){}function m(){}function y(){}var S,b=function C(){},L={Info:0,Debug:1,Warn:2,Error:3,Fatal:4};L[L.Info]="Info",L[L.Debug]="Debug",L[L.Warn]="Warn",L[L.Error]="Error",L[L.Fatal]="Fatal";var I=function(){return S},E={Trace:0,Debug:1,Warn:2,Error:3};function D(e,r){return void 0===r&&(r=E.Debug),{Message:e,Registeredappid:I().getAppId(),AccountName:localStorage.getItem("_accountname"),Subscription:localStorage.getItem("_company"),Category:"Client",Level:r}}E[E.Trace]="Trace",E[E.Debug]="Debug",E[E.Warn]="Warn",E[E.Error]="Error";var T=(M.prototype.mqInit=function(){var r=this;this.env.stompConfig&&(this.stompService.config=this.env.stompConfig,this.stompService.initAndConnect(),this.stompService.state.subscribe(function(e){r.mqConnectionState=e,r.mqConnectionStateObservable.next(e)}))},M.prototype.getAppId=function(){return this.env.logger.appId},M.prototype.getLoggerUrl=function(){return this.loggerUrl?this.loggerUrl:this.env.logger.url},M.prototype.getLoggerPostUrl=function(){return this.getLoggerUrl()+"entries/"+this.getAppId()+"/"},M.prototype.getServerMonitorUrl=function(){return this.serverMonitorUrl?this.serverMonitorUrl:this.env.serverMonitor.url},M.prototype.log=function(e){this._shouldLog(E.Trace)&&console.log("%c"+e,"color:#3daf67"),this._serverLog(E.Trace,e)},M.prototype.debug=function(e){this._shouldLog(E.Debug)&&console.log("%c"+e,"color:#0277bd"),this._serverLog(E.Debug,e)},M.prototype.warn=function(e){this._shouldLog(E.Warn)&&console.log("%c"+e,"color:#FF9633"),this._serverLog(E.Warn,e)},M.prototype.error=function(e){this._shouldLog(E.Error)&&console.error("%c"+e,"color:red"),this._serverLog(E.Error,e)},M.prototype.stat=function(e){console.log("%c"+e,"color:#884EA0"),this._serverLog(E.Trace,e)},M.prototype.getLogs=function(e){if(!e.instanceKey){var r=new b;return r.Result=!1,r.Message="Error - No instanceKey, no party",s.of(r)}var t=this.getLoggerUrl()+"entries/"+e.instanceKey,o=new i.HttpParams;o=o.append("howMany",""+this.howMany),e.accountName&&(o=o.append("accountName",e.accountName)),e.subscriptionKey&&(o=o.append("subscription",e.subscriptionKey)),e.category&&(o=o.append("categories",e.category)),e.apps&&(o=o.append("apps",e.apps)),e.appTypes&&(o=o.append("appTypes",e.appTypes)),e.levels&&(o=o.append("levels",e.levels)),e.rangeDateStart&&e.rangeDateEnd&&(o=e.rangeDateStart===e.rangeDateEnd?o.append("date",e.rangeDateStart):o.append("date",e.rangeDateStart+";"+e.rangeDateEnd));var n={params:o};return this.http.get(t,n).pipe(a.catchError(this.handleError("TbLoggerService.getLogs",!1)))},M.prototype.getApps=function(e){if(!e){var r=new b;return r.Result=!1,r.Message="Error - No appId, no party",s.of(r)}var t=this.getLoggerUrl()+"apps/"+e;return this.http.get(t).pipe(a.catchError(this.handleError("TbLoggerService.getApps",!1)))},M.prototype.getAppTypes=function(e){if(!e){var r=new b;return r.Result=!1,r.Message="Error - No appId, no party",s.of(r)}var t=this.getLoggerUrl()+"appTypes/"+e;return this.http.get(t).pipe(a.catchError(this.handleError("TbLoggerService.getAppTypes",!1)))},M.prototype.getInstanceKey=function(){var e=this.getLoggerUrl()+"appIds";return this.http.get(e).pipe(a.catchError(this.handleError("TbLoggerService.getInstanceKey",!1)))},M.prototype.getSubscriptionKey=function(){var e=this.getLoggerUrl()+"subscriptionKeys";return this.http.get(e).pipe(a.catchError(this.handleError("TbLoggerService.getSubscriptionKey",!1)))},M.prototype.getCategories=function(e){if(!e){var r=new b;return r.Result=!1,r.Message="Error - No appId, no party",s.of(r)}var t=this.getLoggerUrl()+"categories/"+e;return this.http.get(t).pipe(a.catchError(this.handleError("TbLoggerService.getCategories",!1)))},M.prototype.handleError=function(r,t){return void 0===r&&(r="operation"),function(e){return console.error(r+" failed: "+e.error),s.of(t)}},M.prototype.mqConnect=function(e){return this.stompService.subscribe(e).pipe(a.map(function(e){return JSON.parse(e.body)}))},M.prototype.mqConnected=function(){return this.stompService.connected()},M.prototype.mqDisconnect=function(){return this.stompService.disconnect()},M.prototype.getTBInfosLogs=function(e){var r=new i.HttpParams;e.accountName&&(r=r.append("accountName",""+e.accountName)),e.processName&&(r=r.append("processName",""+e.processName)),e.minutes&&(r=r.append("minute",""+e.minutes));var t={params:r},o=this.getServerMonitorUrl()+"tbServers/"+e.instanceKey;return this.http.get(o,t).pipe(a.catchError(this.handleError("TbLoggerService.getTBInfosLogs",!1)))},M.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],M.ctorParameters=function(){return[{type:undefined,decorators:[{type:r.Inject,args:["env"]}]},{type:i.HttpClient},{type:l.StompRService}]},M.ngInjectableDef=r.defineInjectable({factory:function(){return new M(r.inject("env"),r.inject(i.HttpClient),r.inject(l.StompRService))},token:M,providedIn:"root"}),M);function M(e,r,t){var o=this;this.env=e,this.http=r,this.stompService=t,this.howMany=100,this.mqConnectionState=l.StompState.CLOSED,this.mqConnectionStateObservable=new s.BehaviorSubject(l.StompState.CLOSED),this._shouldLog=function(e){return e>=o.env.logger.level},this._serverLog=function(e,r){return o._shouldLog(e)&&o.http.post(o.getLoggerPostUrl(),D(r,e)).toPromise()},S=this,e.stompConfig&&this.mqInit()}var j=(q.prototype.show=function(e,r){void 0===r&&(r="none"),this.notificationService.show({content:e,animation:{type:"slide",duration:200},position:{horizontal:"right",vertical:"bottom"},type:{style:r,icon:!0},hideAfter:4e3})},q.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],q.ctorParameters=function(){return[{type:u.NotificationService}]},q.ngInjectableDef=r.defineInjectable({factory:function(){return new q(r.inject(u.NotificationService))},token:q,providedIn:"root"}),q);function q(e){this.notificationService=e}var N=(w.forRoot=function(){return{ngModule:w,providers:[l.StompRService]}},w.decorators=[{type:r.NgModule,args:[{imports:[t.CommonModule,u.NotificationModule,n.ButtonsModule,c.InputsModule,g.DateInputsModule,o.FormsModule,p.DropDownsModule],providers:[l.StompRService]}]}],w);function w(){}e.EntriesParams=d,e.MonitorParams=h,e.OperationResult=f,e.LoggerOperationResult=b,e.TBServerInfos=v,e.TBServerInfo=m,e.Log=y,e.LogStatus=L,e.prepareLog=D,e.logger=I,e.LogLevel=E,e.TbLoggerService=T,e.TbNotificationService=j,e.TbLoggerModule=N,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=tb-logger.umd.min.js.map