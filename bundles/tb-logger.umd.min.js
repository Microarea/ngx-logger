!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs"),require("rxjs/operators"),require("@stomp/ng2-stompjs"),require("@progress/kendo-angular-notification"),require("@angular/common"),require("@angular/forms"),require("@progress/kendo-angular-buttons"),require("@progress/kendo-angular-dropdowns"),require("@progress/kendo-angular-inputs"),require("@progress/kendo-angular-dateinputs")):"function"==typeof define&&define.amd?define("@tb/logger",["exports","@angular/core","@angular/common/http","rxjs","rxjs/operators","@stomp/ng2-stompjs","@progress/kendo-angular-notification","@angular/common","@angular/forms","@progress/kendo-angular-buttons","@progress/kendo-angular-dropdowns","@progress/kendo-angular-inputs","@progress/kendo-angular-dateinputs"],r):r(((e=e||self).tb=e.tb||{},e.tb.logger={}),e.ng.core,e.ng.common.http,e.rxjs,e.rxjs.operators,e.ng2Stompjs,e.kendoAngularNotification,e.ng.common,e.ng.forms,e.kendoAngularButtons,e.kendoAngularDropdowns,e.kendoAngularInputs,e.kendoAngularDateinputs)}(this,function(e,r,t,o,n,i,a,s,p,c,g,u,l){"use strict";var d=function(){};var h=function(){};var f=function(){};var v=function(){};var m=function(){};var y=function(){};var S=function(){};var b,L={Info:0,Debug:1,Warn:2,Error:3,Fatal:4};L[L.Info]="Info",L[L.Debug]="Debug",L[L.Warn]="Warn",L[L.Error]="Error",L[L.Fatal]="Fatal";var I=function(){return b};var E={Trace:0,Debug:1,Warn:2,Error:3};function D(e,r){return void 0===r&&(r=E.Debug),{Message:e,Registeredappid:I().getAppId(),AccountName:localStorage.getItem("_accountname"),Subscription:localStorage.getItem("_company"),Category:"Client",Level:r}}E[E.Trace]="Trace",E[E.Debug]="Debug",E[E.Warn]="Warn",E[E.Error]="Error";var T=function(){function e(e,r,t){var n=this;this.env=e,this.http=r,this.stompService=t,this.howMany=100,this.mqConnectionState=i.StompState.CLOSED,this.mqConnectionStateObservable=new o.BehaviorSubject(i.StompState.CLOSED),this._shouldLog=function(e){return e>=n.env.logger.level},this._serverLog=function(e,r){return n._shouldLog(e)&&n.http.post(n.getLoggerPostUrl(),D(r,e)).toPromise()},b=this,e.stompConfig&&this.mqInit()}return e.prototype.mqInit=function(){var e=this;this.env.stompConfig&&(this.stompService.config=this.env.stompConfig,this.stompService.initAndConnect(),this.stompService.state.subscribe(function(r){e.mqConnectionState=r,e.mqConnectionStateObservable.next(r)}))},e.prototype.getAppId=function(){return this.env.logger.appId},e.prototype.getLoggerUrl=function(){return this.loggerUrl?this.loggerUrl:this.env.logger.url},e.prototype.getLoggerPostUrl=function(){return this.getLoggerUrl()+"entries/"+this.getAppId()+"/"},e.prototype.getServerMonitorUrl=function(){return this.serverMonitorUrl?this.serverMonitorUrl:this.env.serverMonitor.url},e.prototype.log=function(e){this._shouldLog(E.Trace)&&console.log("%c"+e,"color:#3daf67"),this._serverLog(E.Trace,e)},e.prototype.debug=function(e){this._shouldLog(E.Debug)&&console.log("%c"+e,"color:#0277bd"),this._serverLog(E.Debug,e)},e.prototype.warn=function(e){this._shouldLog(E.Warn)&&console.log("%c"+e,"color:#FF9633"),this._serverLog(E.Warn,e)},e.prototype.error=function(e){this._shouldLog(E.Error)&&console.error("%c"+e,"color:red"),this._serverLog(E.Error,e)},e.prototype.stat=function(e){console.log("%c"+e,"color:#884EA0"),this._serverLog(E.Trace,e)},e.prototype.getLogs=function(e){if(!e.instanceKey){var r=new v;return r.Result=!1,r.Message="Error - No instanceKey, no party",o.of(r)}var i=this.getLoggerUrl()+"entries/"+e.instanceKey,a=new t.HttpParams;a=a.append("howMany",""+this.howMany),e.accountName&&(a=a.append("accountName",e.accountName)),e.subscriptionKey&&(a=a.append("subscription",e.subscriptionKey)),e.category&&(a=a.append("categories",e.category)),e.apps&&(a=a.append("apps",e.apps)),e.appTypes&&(a=a.append("appTypes",e.appTypes)),e.levels&&(a=a.append("levels",e.levels)),e.rangeDateStart&&e.rangeDateEnd&&(a=e.rangeDateStart===e.rangeDateEnd?a.append("date",e.rangeDateStart):a.append("date",e.rangeDateStart+";"+e.rangeDateEnd));var s={params:a};return this.http.get(i,s).pipe(n.catchError(this.handleError("TbLoggerService.getLogs",!1)))},e.prototype.getApps=function(e){if(!e){var r=new v;return r.Result=!1,r.Message="Error - No appId, no party",o.of(r)}var t=this.getLoggerUrl()+"apps/"+e;return this.http.get(t).pipe(n.catchError(this.handleError("TbLoggerService.getApps",!1)))},e.prototype.getAppTypes=function(e){if(!e){var r=new v;return r.Result=!1,r.Message="Error - No appId, no party",o.of(r)}var t=this.getLoggerUrl()+"appTypes/"+e;return this.http.get(t).pipe(n.catchError(this.handleError("TbLoggerService.getAppTypes",!1)))},e.prototype.getInstanceKey=function(){var e=this.getLoggerUrl()+"appIds";return this.http.get(e).pipe(n.catchError(this.handleError("TbLoggerService.getInstanceKey",!1)))},e.prototype.getSubscriptionKey=function(){var e=this.getLoggerUrl()+"subscriptionKeys";return this.http.get(e).pipe(n.catchError(this.handleError("TbLoggerService.getSubscriptionKey",!1)))},e.prototype.getCategories=function(e){if(!e){var r=new v;return r.Result=!1,r.Message="Error - No appId, no party",o.of(r)}var t=this.getLoggerUrl()+"categories/"+e;return this.http.get(t).pipe(n.catchError(this.handleError("TbLoggerService.getCategories",!1)))},e.prototype.handleError=function(e,r){return void 0===e&&(e="operation"),function(t){return console.error(e+" failed: "+t.error),o.of(r)}},e.prototype.mqConnect=function(e){return this.stompService.subscribe(e).pipe(n.map(function(e){return JSON.parse(e.body)}))},e.prototype.mqConnected=function(){return this.stompService.connected()},e.prototype.mqDisconnect=function(){return this.stompService.disconnect()},e.prototype.getTBInfosLogs=function(e){var r=new t.HttpParams;e.accountName&&(r=r.append("accountName",""+e.accountName)),e.processName&&(r=r.append("processName",""+e.processName)),e.minutes&&(r=r.append("minute",""+e.minutes));var o={params:r},i=this.getServerMonitorUrl()+"tbServers/"+e.instanceKey;return this.http.get(i,o).pipe(n.catchError(this.handleError("TbLoggerService.getTBInfosLogs",!1)))},e.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:void 0,decorators:[{type:r.Inject,args:["env"]}]},{type:t.HttpClient},{type:i.StompRService}]},e.ngInjectableDef=r.ɵɵdefineInjectable({factory:function(){return new e(r.ɵɵinject("env"),r.ɵɵinject(t.HttpClient),r.ɵɵinject(i.StompRService))},token:e,providedIn:"root"}),e}();var M=function(){function e(e){this.notificationService=e}return e.prototype.show=function(e,r){void 0===r&&(r="none"),this.notificationService.show({content:e,animation:{type:"slide",duration:200},position:{horizontal:"right",vertical:"bottom"},type:{style:r,icon:!0},hideAfter:4e3})},e.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:a.NotificationService}]},e.ngInjectableDef=r.ɵɵdefineInjectable({factory:function(){return new e(r.ɵɵinject(a.NotificationService))},token:e,providedIn:"root"}),e}();var j=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[i.StompRService]}},e.decorators=[{type:r.NgModule,args:[{imports:[s.CommonModule,a.NotificationModule,c.ButtonsModule,u.InputsModule,l.DateInputsModule,p.FormsModule,g.DropDownsModule],providers:[i.StompRService]}]}],e}();e.EntriesParams=d,e.Log=S,e.LogLevel=E,e.LogStatus=L,e.LoggerOperationResult=v,e.MonitorParams=h,e.OperationResult=f,e.TBServerInfo=y,e.TBServerInfos=m,e.TbLoggerModule=j,e.TbLoggerService=T,e.TbNotificationService=M,e.logger=I,e.prepareLog=D,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=tb-logger.umd.min.js.map