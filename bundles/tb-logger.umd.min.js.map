{"version":3,"sources":["ng://@tb/logger/lib/models/entries.model.ts","ng://@tb/logger/lib/models/monitor.model.ts","ng://@tb/logger/lib/models/operation-result.model.ts","ng://@tb/logger/lib/models/logger-operation-result.model.ts","ng://@tb/logger/lib/models/log.model.ts","ng://@tb/logger/lib/services/tb-logger.service.ts","ng://@tb/logger/lib/models/log-status.enum.ts","ng://@tb/logger/lib/services/notification.service.ts","ng://@tb/logger/lib/tb-logger.module.ts"],"names":["EntriesParams","MonitorParams","OperationResult","Log","loggerInstance","LoggerOperationResult","Info","Debug","Warn","Error","Fatal","logger","Trace","prepareLog","message","logLevel","LogLevel","Message","Registeredappid","getAppId","AccountName","localStorage","getItem","Subscription","Category","Level","TbLoggerService","prototype","mqInit","_this","this","env","stompConfig","stompService","config","initAndConnect","state","subscribe","status","mqConnectionState","mqConnectionStateObservable","next","sessionStorage","appId","getLoggerUrl","loggerUrl","url","getLoggerPostUrl","getServerMonitorUrl","serverMonitorUrl","serverMonitor","log","_shouldLog","console","_serverLog","debug","warn","error","stat","getLogs","params","instanceKey","Result","of","p","HttpParams","append","howMany","accountName","subscriptionKey","category","apps","appTypes","levels","rangeDateStart","rangeDateEnd","httpOptions","http","get","pipe","catchError","handleError","getApps","getAppTypes","getInstanceKey","getSubscriptionKey","getCategories","operation","result","mqConnect","queueName","map","msg","JSON","parse","body","mqConnected","connected","mqDisconnect","disconnect","getTBInfosLogs","processName","minutes","Injectable","args","providedIn","Inject","HttpClient","StompRService","StompState","CLOSED","BehaviorSubject","level","post","toPromise","TbNotificationService","show","style","notificationService","content","animation","type","duration","position","horizontal","vertical","icon","hideAfter","NotificationService","TbLoggerModule","forRoot","ngModule","providers","NgModule","imports","CommonModule","NotificationModule","ButtonsModule","InputsModule","DateInputsModule","FormsModule","DropDownsModule"],"mappings":"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","sourcesContent":["export class EntriesParams {\r\n    instanceKey: string;\r\n    subscriptionKey: string;\r\n    apps: string;\r\n    appTypes: string;\r\n    category: string;\r\n    howMany: string;\r\n    offSet: string;\r\n    levels: string;\r\n    textToFind: string;\r\n    useHistory: string;\r\n    accountName: string;\r\n    rangeDateStart: string;\r\n    rangeDateEnd: string;\r\n\r\n    constructor() {}\r\n}\r\n","export class MonitorParams {\r\n    accountName: string;\r\n    instanceKey: string;\r\n    processName: string;\r\n    minutes: string;\r\n\r\n    constructor() {}\r\n}\r\n","export class OperationResult {\r\n    Result: boolean;\r\n    Message?: string;\r\n    Code?: number;\r\n    Content?: any;\r\n\r\n    constructor() {}\r\n}\r\n","export class LoggerOperationResult {\r\n    Result: boolean;\r\n    Message?: string;\r\n    Code?: number;\r\n    Content?: any;\r\n\r\n    constructor() {}\r\n}\r\n\r\nexport class TBServerInfos {\r\n    tread: TBServerInfo[];\r\n    constructor() {}\r\n}\r\n\r\nexport class TBServerInfo {\r\n    DateTime: string;\r\n    ProcessName: string;\r\n    LoginNumber?: number;\r\n    DocumentNumber?: number;\r\n\r\n    DocMetrics?: any[];\r\n    LernelMS?: number;\r\n    LoginInfos?: any[];\r\n    PhisicalMemory?: number;\r\n    UserMS?: number;\r\n    VirtualMemory?: number;\r\n\r\n    threads?: any[];\r\n\r\n    constructor() {}\r\n}\r\n","export class Log {\r\n    _id: string;\r\n    LogEntry: {\r\n        App: string; // ERP, PAI, MDC, TBF\r\n        RegisteredAppId: string; // instance key\r\n        RegisteredAppType: string; // TBLOADER, NETCORE, NG, PROVISIONING\r\n        Category: string; //\r\n        Module: string;\r\n        SubModule: string;\r\n        Document: string;\r\n        Subscription: string;\r\n        AccountName: string;\r\n        Lifetime: string;\r\n        Operation: string;\r\n        ContextDescription: string;\r\n        Method: string;\r\n        EntryCreated: string;\r\n        Message: string;\r\n        Level: number;\r\n    };\r\n\r\n    constructor() {}\r\n}\r\n","import { Injectable, Inject, isDevMode } from '@angular/core';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\n\r\nimport { Observable, of, BehaviorSubject } from 'rxjs';\r\nimport { catchError, map } from 'rxjs/operators';\r\n\r\nimport { StompRService, StompState } from '@stomp/ng2-stompjs';\r\nimport { Message } from '@stomp/stompjs';\r\n\r\nimport { LoggerOperationResult, TBServerInfo } from '../models/logger-operation-result.model';\r\nimport { EntriesParams } from '../models/entries.model';\r\nimport { MonitorParams } from '../models/monitor.model';\r\n\r\nlet loggerInstance: TbLoggerService;\r\nexport const logger = () => loggerInstance;\r\n\r\nexport interface LogEntry {\r\n    Message: string;\r\n    Registeredappid: string;\r\n    AccountName?: string;\r\n    Subscription?: string;\r\n    App?: string;\r\n    Category?: string;\r\n    Level: LogLevel;\r\n}\r\n\r\nexport enum LogLevel {\r\n    Trace = 0,\r\n    Debug,\r\n    Warn,\r\n    Error\r\n}\r\n\r\nexport function prepareLog(message: string, logLevel: LogLevel = LogLevel.Debug) {\r\n    const log: LogEntry = {\r\n        Message: message,\r\n        Registeredappid: logger().getAppId(),\r\n        AccountName: localStorage.getItem('_accountname'),\r\n        Subscription: localStorage.getItem('_company'),\r\n        Category: 'Client',\r\n        Level: logLevel\r\n    };\r\n    return log;\r\n}\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class TbLoggerService {\r\n    public loggerUrl: string;\r\n    public serverMonitorUrl: string;\r\n    private howMany = 100;\r\n\r\n    public mqConnectionState: StompState = StompState.CLOSED;\r\n    public mqConnectionStateObservable: BehaviorSubject<StompState> = new BehaviorSubject(StompState.CLOSED);\r\n\r\n    constructor(@Inject('env') private env, private http: HttpClient, public stompService: StompRService) {\r\n        loggerInstance = this;\r\n        if (env.stompConfig) this.mqInit();\r\n    }\r\n\r\n    mqInit() {\r\n        if (this.env.stompConfig) {\r\n            this.stompService.config = this.env.stompConfig;\r\n            this.stompService.initAndConnect();\r\n            this.stompService.state.subscribe((status: StompState) => {\r\n                this.mqConnectionState = status;\r\n                this.mqConnectionStateObservable.next(status);\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Ritorna la App Id dell'applicazione frontend che sta loggando,\r\n     * caricata da un file di configurazione caricato dinamicamente (assets/environment.json)\r\n     */\r\n    getAppId() {\r\n        return sessionStorage.getItem('_instanceKey') || this.env.logger.appId;\r\n    }\r\n\r\n    /**\r\n     * Ritorna la base url del logger,\r\n     * caricata da un file di configurazione caricato dinamicamente (assets/environment.json)\r\n     */\r\n    getLoggerUrl() {\r\n        return this.loggerUrl ? this.loggerUrl : this.env.logger.url;\r\n    }\r\n\r\n    /**\r\n     * Ritorna la api per inserire log con appId configurato in environment.json\r\n     */\r\n    getLoggerPostUrl() {\r\n        return `${this.getLoggerUrl()}entries/${this.getAppId()}/`;\r\n    }\r\n\r\n    /**\r\n     * M4 Backend URL\r\n     */\r\n    getServerMonitorUrl() {\r\n        return this.serverMonitorUrl ? this.serverMonitorUrl : this.env.serverMonitor.url;\r\n    }\r\n\r\n    private _shouldLog = (logLevel: LogLevel) => logLevel >= this.env.logger.level;\r\n    private _serverLog = (logLevel: LogLevel, message: string) =>\r\n        this._shouldLog(logLevel) && this.http.post(this.getLoggerPostUrl(), prepareLog(message, logLevel)).toPromise();\r\n\r\n    /**\r\n     * @param message\r\n     * @param optionalParams\r\n     */\r\n    log(message?: any): void {\r\n        if (this._shouldLog(LogLevel.Trace)) console.log(`%c${message}`, `color:#3daf67`);\r\n        this._serverLog(LogLevel.Trace, message);\r\n    }\r\n\r\n    /**\r\n     * @param message\r\n     * @param optionalParams\r\n     */\r\n    debug(message?: any): void {\r\n        if (this._shouldLog(LogLevel.Debug)) console.log(`%c${message}`, `color:#0277bd`);\r\n        this._serverLog(LogLevel.Debug, message);\r\n    }\r\n\r\n    /**\r\n     * @param message\r\n     * @param optionalParams\r\n     */\r\n    warn(message?: any): void {\r\n        if (this._shouldLog(LogLevel.Warn)) console.log(`%c${message}`, `color:#FF9633`);\r\n        this._serverLog(LogLevel.Warn, message);\r\n    }\r\n\r\n    /**\r\n     * @param message\r\n     * @param optionalParams\r\n     */\r\n    error(message?: any): void {\r\n        if (this._shouldLog(LogLevel.Error)) console.error(`%c${message}`, `color:red`);\r\n        this._serverLog(LogLevel.Error, message);\r\n    }\r\n\r\n    /**\r\n     * Log per statistiche client (es: usato da login page per tracciare risoluzione schermo)\r\n     *\r\n     * @param message\r\n     * @param optionalParams\r\n     */\r\n    stat(message?: any): void {\r\n        console.log(`%c${message}`, `color:#884EA0`);\r\n        this._serverLog(LogLevel.Trace, message);\r\n    }\r\n\r\n    /**\r\n     * Return logs: LoggerOperationResult\r\n     *\r\n     * @param params: EntriesParams\r\n     */\r\n    public getLogs(params: EntriesParams): Observable<boolean | LoggerOperationResult> {\r\n        if (!params.instanceKey) {\r\n            const error = new LoggerOperationResult();\r\n            error.Result = false;\r\n            error.Message = 'Error - No instanceKey, no party';\r\n            return of(error);\r\n        }\r\n        // console.log('this.getLoggerUrl()', this.getLoggerUrl());\r\n        const url = this.getLoggerUrl() + `entries/${params.instanceKey}`;\r\n\r\n        let p = new HttpParams();\r\n        p = p.append('howMany', '' + this.howMany);\r\n        if (params.accountName) p = p.append('accountName', params.accountName);\r\n        if (params.subscriptionKey) p = p.append('subscription', params.subscriptionKey);\r\n        if (params.category) p = p.append('categories', params.category);\r\n        if (params.apps) p = p.append('apps', params.apps);\r\n        if (params.appTypes) p = p.append('appTypes', params.appTypes);\r\n        if (params.levels) p = p.append('levels', params.levels);\r\n        if (params.rangeDateStart && params.rangeDateEnd) {\r\n            if (params.rangeDateStart === params.rangeDateEnd) p = p.append('date', params.rangeDateStart);\r\n            else p = p.append('date', params.rangeDateStart + ';' + params.rangeDateEnd);\r\n        }\r\n        const httpOptions = {\r\n            params: p\r\n        };\r\n\r\n        return this.http.get<LoggerOperationResult>(url, httpOptions).pipe(\r\n            // tap(op => console.log('TbLoggerService.getLogs', op)),\r\n            catchError(this.handleError('TbLoggerService.getLogs', false))\r\n        );\r\n    }\r\n\r\n    public getApps(appId: string): Observable<boolean | LoggerOperationResult> {\r\n        if (!appId) {\r\n            const error = new LoggerOperationResult();\r\n            error.Result = false;\r\n            error.Message = 'Error - No appId, no party';\r\n            return of(error);\r\n        }\r\n\r\n        const url = this.getLoggerUrl() + `apps/${appId}`;\r\n\r\n        return this.http.get<LoggerOperationResult>(url).pipe(\r\n            // tap(op => console.log('TbLoggerService.getApps with appId: ', appId, op)),\r\n            catchError(this.handleError('TbLoggerService.getApps', false))\r\n        );\r\n    }\r\n\r\n    public getAppTypes(appId: string): Observable<boolean | LoggerOperationResult> {\r\n        if (!appId) {\r\n            const error = new LoggerOperationResult();\r\n            error.Result = false;\r\n            error.Message = 'Error - No appId, no party';\r\n            return of(error);\r\n        }\r\n\r\n        const url = this.getLoggerUrl() + `appTypes/${appId}`;\r\n\r\n        return this.http.get<LoggerOperationResult>(url).pipe(\r\n            // tap(op => console.log('TbLoggerService.getAppTypes with appId: ', appId, op)),\r\n            catchError(this.handleError('TbLoggerService.getAppTypes', false))\r\n        );\r\n    }\r\n\r\n    public getInstanceKey(): Observable<boolean | LoggerOperationResult> {\r\n        const url = this.getLoggerUrl() + `appIds`;\r\n\r\n        return this.http.get<LoggerOperationResult>(url).pipe(\r\n            // tap(op => console.log(url, 'TbLoggerService.getInstanceKey with appId: ', op)),\r\n            catchError(this.handleError('TbLoggerService.getInstanceKey', false))\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Legge tutte le subscription\r\n     */\r\n    public getSubscriptionKey(): Observable<boolean | LoggerOperationResult> {\r\n        const url = this.getLoggerUrl() + `subscriptionKeys`;\r\n\r\n        return this.http.get<LoggerOperationResult>(url).pipe(\r\n            // tap(op => console.log('TbLoggerService.getSubscriptionKey: ', op)),\r\n            catchError(this.handleError('TbLoggerService.getSubscriptionKey', false))\r\n        );\r\n    }\r\n\r\n    public getCategories(appId: string): Observable<boolean | LoggerOperationResult> {\r\n        if (!appId) {\r\n            const error = new LoggerOperationResult();\r\n            error.Result = false;\r\n            error.Message = 'Error - No appId, no party';\r\n            return of(error);\r\n        }\r\n\r\n        const url = this.getLoggerUrl() + `categories/${appId}`;\r\n\r\n        return this.http.get<LoggerOperationResult>(url).pipe(\r\n            // tap(op => console.log('TbLoggerService.getCategories with appId: ', appId, op)),\r\n            catchError(this.handleError('TbLoggerService.getCategories', false))\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Handle Http operation that failed.\r\n     * Let the app continue.\r\n     * @param operation - name of the operation that failed\r\n     * @param result - optional value to return as the observable result\r\n     */\r\n    public handleError<T>(operation = 'operation', result?: T) {\r\n        return (error: any): Observable<T> => {\r\n            console.error(`${operation} failed: ${error.error}`);\r\n\r\n            // Let the app keep running by returning an empty result.\r\n            return of(result as T);\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Connessione a RabbitMQ\r\n     */\r\n    public mqConnect(queueName: string) {\r\n        return this.stompService.subscribe(queueName).pipe(map((msg: Message) => JSON.parse(msg.body)));\r\n    }\r\n\r\n    public mqConnected() {\r\n        return this.stompService.connected();\r\n    }\r\n    public mqDisconnect() {\r\n        return this.stompService.disconnect();\r\n    }\r\n\r\n    // -------------------------------------------------------------------------------------------------------\r\n    // PARTE TBSERVERMONITOR\r\n    // -------------------------------------------------------------------------------------------------------\r\n    public getTBInfosLogs(params: MonitorParams): Observable<boolean | TBServerInfo[]> {\r\n        let p = new HttpParams();\r\n\r\n        if (params.accountName) p = p.append('accountName', '' + params.accountName);\r\n        if (params.processName) p = p.append('processName', '' + params.processName);\r\n        if (params.minutes) p = p.append('minute', '' + params.minutes);\r\n\r\n        const httpOptions = { params: p };\r\n\r\n        const url = this.getServerMonitorUrl() + `tbServers/${params.instanceKey}`;\r\n\r\n        return this.http.get<TBServerInfo[]>(url, httpOptions).pipe(catchError(this.handleError('TbLoggerService.getTBInfosLogs', false)));\r\n    }\r\n}\r\n","export enum LogStatus {\r\n    Info = 0,\r\n    Debug = 1,\r\n    Warn = 2,\r\n    Error = 3,\r\n    Fatal = 4\r\n}\r\n","import { Injectable, Inject } from '@angular/core';\r\n\r\nimport { NotificationService } from '@progress/kendo-angular-notification';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class TbNotificationService {\r\n    constructor(private notificationService: NotificationService) {}\r\n\r\n    public show(msg, style: any = 'none'): void {\r\n        this.notificationService.show({\r\n            content: msg,\r\n            animation: { type: 'slide', duration: 200 },\r\n            position: { horizontal: 'right', vertical: 'bottom' },\r\n            type: { style: style, icon: true },\r\n            hideAfter: 4000\r\n        });\r\n    }\r\n}\r\n","import { NgModule, ModuleWithProviders, Inject } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { ButtonsModule } from '@progress/kendo-angular-buttons';\r\nimport { DropDownsModule } from '@progress/kendo-angular-dropdowns';\r\nimport { InputsModule } from '@progress/kendo-angular-inputs';\r\nimport { DateInputsModule } from '@progress/kendo-angular-dateinputs';\r\nimport { NotificationModule } from '@progress/kendo-angular-notification';\r\n\r\nimport { StompRService } from '@stomp/ng2-stompjs';\r\n\r\n@NgModule({\r\n    imports: [CommonModule, NotificationModule, ButtonsModule, InputsModule, DateInputsModule, FormsModule, DropDownsModule],\r\n    providers: [StompRService]\r\n})\r\nexport class TbLoggerModule {\r\n    static forRoot(): ModuleWithProviders {\r\n        return {\r\n            ngModule: TbLoggerModule,\r\n            providers: [StompRService]\r\n        };\r\n    }\r\n}\r\n"]}